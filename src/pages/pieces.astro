---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="Pieces | 碎片" activeNav="pieces">
    <div class="divider-diamond">
        <span>◆</span><span>◆</span><span>◆</span>
    </div>

    <!-- Status Cafe Section (Plugin Version) -->
    <div id="statuscafe">
        <div id="statuscafe-username">Loading...</div>
        <div id="statuscafe-content"></div>
    </div>
    
    <script>
        // 替换 'igloos' 为你的 Status Cafe 用户名
        const username = 'igloos';
        
        fetch(`https://status.cafe/users/${username}/statuses.json`)
          .then( r => r.json() )
          .then( r => {
            if (!r.statuses || r.statuses.length === 0) {
              document.getElementById("statuscafe-content").innerHTML = "No status yet."
              return
            }
            
            // 显示作者信息
            document.getElementById("statuscafe-username").innerHTML = 
                `<a href="https://status.cafe/users/${username}" target="_blank">${r.statuses[0].author}</a> 的所有状态`;
            
            // 渲染所有状态
            const statusesHTML = r.statuses.map(status => `
              <div class="status-item">
                <div class="status-header">
                  <span class="status-face">${status.face}</span>
                  <span class="status-time">${status.timeAgo}</span>
                </div>
                <div class="status-content">${status.content}</div>
              </div>
            `).join('');
            
            document.getElementById("statuscafe-content").innerHTML = statusesHTML;
          })
          .catch(err => {
              document.getElementById("statuscafe-username").innerHTML = "无法加载状态";
              console.error(err);
          });
    </script>

    <div style="height: 100px;"></div>
</BaseLayout>

<style>
    .divider-diamond { display: flex; justify-content: center; align-items: center; gap: 8px; color: #1a3c5e; font-size: 12px; margin: 20px 0 50px 0; opacity: 0.9; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    /* Status Cafe Styles */
    #statuscafe {
        padding: 20px;
        /* 磨砂玻璃效果 */
        background-color: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
        
        border-radius: 12px;
        margin: 40px 0;
        position: relative;
        font-size: 1rem;
        color: #444;
        animation: fadeIn 0.5s ease;
    }

    #statuscafe-username {
        margin-bottom: 10px;
        font-weight: bold;
        color: var(--text-main);
        font-size: 1.1rem;
    }
    
    #statuscafe-username a {
        color: inherit;
        text-decoration: none;
    }
    
    #statuscafe-username a:hover {
        color: var(--col-4-dark);
        text-decoration: underline;
    }

    #statuscafe-content {
        margin: 0;
        line-height: 1.6;
    }
    
    .status-item {
        padding: 15px 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    }
    
    .status-item:last-child {
        border-bottom: none;
    }
    
    .status-header {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 8px;
    }
    
    .status-face {
        font-size: 1.3em;
    }
    
    .status-time {
        font-size: 0.85em;
        color: #666;
        font-weight: normal;
    }
    
    .status-content {
        color: #444;
        line-height: 1.6;
    }
</style>